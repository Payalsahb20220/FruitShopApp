{"ast":null,"code":"var _jsxFileName = \"/Users/payalsah/Documents/FruitShopApp/screens/CartScreen.tsx\";\nimport React, { useEffect, useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Animated from \"react-native-web/dist/exports/Animated\";\nimport { useCart } from '../contexts/CartContext';\nimport { useNavigation } from '@react-navigation/native';\nimport { getFirestore, doc, getDoc } from 'firebase/firestore';\nimport { auth } from '../firebaseConfig';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport * as Linking from 'expo-linking';\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport * as Location from 'expo-location';\nimport haversine from 'haversine-distance';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst SHOP_LOCATION = {\n  latitude: 28.7041,\n  longitude: 77.1025\n};\nexport default function CartScreen() {\n  const {\n    cart,\n    removeFromCart,\n    totalPrice\n  } = useCart();\n  const [currentUser, setCurrentUser] = useState(null);\n  const [selectedPayment, setSelectedPayment] = useState(null);\n  const [name, setName] = useState('');\n  const [contactNumber, setContactNumber] = useState('');\n  const [address, setAddress] = useState('');\n  const [isExpanded, setIsExpanded] = useState(true);\n  const [animatedHeight] = useState(new Animated.Value(0));\n  const navigation = useNavigation();\n  const [userDetails, setUserDetails] = useState(null);\n  const [location, setLocation] = useState(null);\n  const [distance, setDistance] = useState(null);\n  useEffect(() => {\n    const fetchUserDetails = async () => {\n      const user = auth.currentUser;\n      if (user) {\n        try {\n          const db = getFirestore();\n          const userDoc = await getDoc(doc(db, 'users', user.uid));\n          if (userDoc.exists()) {\n            setUserDetails(userDoc.data());\n            setAddress(userDoc.data().address || '');\n            setName(userDoc.data());\n          }\n        } catch (error) {\n          console.error('Error fetching user details: ', error);\n        }\n      }\n    };\n    fetchUserDetails();\n  }, []);\n  const getCurrentLocation = async () => {\n    const {\n      status\n    } = await Location.requestForegroundPermissionsAsync();\n    if (status !== 'granted') {\n      Alert.alert('Permission Denied', 'Location access is required to detect your address.');\n      return;\n    }\n    const location = await Location.getCurrentPositionAsync({});\n    setLocation(location.coords);\n    setAddress(`Lat: ${location.coords.latitude}, Lng: ${location.coords.longitude}`);\n    calculateDistance(location.coords);\n  };\n  const calculateDistance = userCoords => {\n    if (!userCoords) return;\n    const distanceInMeters = haversine(SHOP_LOCATION, userCoords);\n    const distanceInKm = distanceInMeters / 1000;\n    setDistance(distanceInKm.toFixed(2));\n    if (distanceInKm > 5) {\n      Alert.alert('Out of Delivery Range', 'Sorry, delivery is only available within 5km.');\n    }\n  };\n  const handleManualAddress = () => {\n    Alert.alert('Manual Address', 'Your address has been updated.');\n  };\n  const showAlert = (title, message, onRemove) => {\n    if (Platform.OS === 'web') {\n      const confirmation = window.confirm(`${title}: ${message}`);\n      if (confirmation) {\n        onRemove();\n      }\n    } else {\n      Alert.alert(title, message, [{\n        text: 'Cancel',\n        style: 'cancel'\n      }, {\n        text: 'Ok',\n        onPress: onRemove\n      }]);\n    }\n  };\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, user => {\n      setCurrentUser(user);\n    });\n    return () => unsubscribe();\n  }, []);\n  const handleRemove = id => {\n    showAlert('Remove Item', 'Are you sure you want to remove this item from your cart?', () => removeFromCart(id));\n  };\n  const sendOrderMessage = paymentType => {\n    const orderDetails = cart.map(item => `${item.name} x${item.cartQuantity}`).join(', ');\n    const message = `Order Details:\\nName: ${name}\\nContact: ${contactNumber}\\nProducts: ${orderDetails}\\nTotal Price: â‚¹${totalPrice.toFixed(2)}\\nPayment Method: ${paymentType}`;\n    Linking.openURL(`sms:${contactNumber}?body=${encodeURIComponent(message)}`);\n    Linking.openURL(`whatsapp://send?phone=${contactNumber}&text=${encodeURIComponent(message)}`);\n    const ownerNumber = '+916205720019';\n    Linking.openURL(`sms:${ownerNumber}?body=${encodeURIComponent(message)}`);\n    Linking.openURL(`whatsapp://send?phone=${ownerNumber}&text=${encodeURIComponent(message)}`);\n  };\n  const handleCheckout = () => {\n    if (!currentUser) {\n      showAlert('Authentication Required', 'You need to log in to proceed to checkout.', () => navigation.navigate('Login'));\n    } else if (!name || !contactNumber || !address) {\n      showAlert('Missing Information', 'Please provide your name , contact number and address.', () => {});\n    } else if (selectedPayment === 'Cash on Delivery') {\n      showAlert('Order Confirmed', 'Your order has been placed and will be paid on delivery.', () => {\n        sendOrderMessage('Cash on Delivery');\n      });\n    } else if (selectedPayment === 'Online Payment') {\n      navigation.navigate('OnlinePayment', {\n        name,\n        contactNumber,\n        totalPrice,\n        cart,\n        address\n      });\n      sendOrderMessage('Online Payment');\n    } else {\n      showAlert('Select Payment Method', 'Please choose a payment method to proceed.', () => {});\n    }\n  };\n  useEffect(() => {\n    Animated.timing(animatedHeight, {\n      toValue: isExpanded ? 300 : 0,\n      duration: 300,\n      useNativeDriver: false\n    }).start();\n  }, [isExpanded]);\n  const toggleExpand = () => {\n    setIsExpanded(prev => !prev);\n  };\n  const renderCartItem = ({\n    item\n  }) => _jsxDEV(View, {\n    style: styles.cartItem,\n    children: [_jsxDEV(Text, {\n      style: styles.itemText,\n      children: item.name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 433,\n      columnNumber: 7\n    }, this), _jsxDEV(Text, {\n      style: styles.itemText,\n      children: [\"Quantity: \", item.cartQuantity]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 434,\n      columnNumber: 7\n    }, this), _jsxDEV(Text, {\n      style: styles.itemText,\n      children: [\"Price: \\u20B9\", item.price.toFixed(2)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 435,\n      columnNumber: 7\n    }, this), _jsxDEV(TouchableOpacity, {\n      onPress: () => handleRemove(item.id),\n      style: styles.removeButton,\n      children: _jsxDEV(Text, {\n        style: styles.removeButtonText,\n        children: \"Remove\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 437,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 436,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 432,\n    columnNumber: 5\n  }, this);\n  return _jsxDEV(View, {\n    style: styles.container,\n    children: [_jsxDEV(Text, {\n      style: styles.title,\n      children: \"Your Cart\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 444,\n      columnNumber: 7\n    }, this), cart.length === 0 ? _jsxDEV(Text, {\n      style: styles.emptyCartText,\n      children: \"Your cart is empty.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 447,\n      columnNumber: 9\n    }, this) : _jsxDEV(_Fragment, {\n      children: [_jsxDEV(FlatList, {\n        data: cart,\n        renderItem: renderCartItem,\n        keyExtractor: item => item.id.toString()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 11\n      }, this), _jsxDEV(Animated.View, {\n        style: {\n          height: animatedHeight,\n          overflow: 'hidden'\n        },\n        children: _jsxDEV(FlatList, {\n          data: cart,\n          renderItem: renderCartItem,\n          keyExtractor: item => item.id.toString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 457,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 456,\n        columnNumber: 13\n      }, this), _jsxDEV(TouchableOpacity, {\n        onPress: toggleExpand,\n        style: styles.toggleButton,\n        children: _jsxDEV(Text, {\n          style: styles.toggleButtonText,\n          children: isExpanded ? 'View Less' : 'View All Items'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 464,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 463,\n        columnNumber: 13\n      }, this), _jsxDEV(View, {\n        style: styles.addressContainer,\n        children: [_jsxDEV(Text, {\n          style: styles.inputLabel,\n          children: \"Name:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 498,\n          columnNumber: 13\n        }, this), _jsxDEV(TextInput, {\n          style: styles.input,\n          value: name,\n          onChangeText: setName,\n          placeholder: \"Enter your name\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 499,\n          columnNumber: 13\n        }, this), _jsxDEV(Text, {\n          style: styles.inputLabel,\n          children: \"Contact Number:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 505,\n          columnNumber: 13\n        }, this), _jsxDEV(TextInput, {\n          style: styles.input,\n          value: contactNumber,\n          onChangeText: setContactNumber,\n          placeholder: \"Enter your contact number\",\n          keyboardType: \"phone-pad\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 13\n        }, this), _jsxDEV(Text, {\n          style: styles.inputLabel,\n          children: \"Address:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 513,\n          columnNumber: 13\n        }, this), _jsxDEV(TextInput, {\n          style: styles.input,\n          value: address,\n          onChangeText: setAddress,\n          placeholder: \"Enter your address\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 514,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 497,\n        columnNumber: 11\n      }, this), _jsxDEV(View, {\n        style: styles.paymentContainer,\n        children: [_jsxDEV(Text, {\n          style: styles.paymentTitle,\n          children: \"Select Payment Method:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 525,\n          columnNumber: 13\n        }, this), _jsxDEV(TouchableOpacity, {\n          style: [styles.paymentOption, selectedPayment === 'Cash on Delivery' && styles.selectedOption],\n          onPress: () => setSelectedPayment('Cash on Delivery'),\n          children: _jsxDEV(Text, {\n            style: styles.paymentText,\n            children: \"Cash on Delivery\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 533,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 526,\n          columnNumber: 13\n        }, this), _jsxDEV(TouchableOpacity, {\n          style: [styles.paymentOption, selectedPayment === 'Online Payment' && styles.selectedOption],\n          onPress: () => setSelectedPayment('Online Payment'),\n          children: _jsxDEV(Text, {\n            style: styles.paymentText,\n            children: \"Online Payment\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 542,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 524,\n        columnNumber: 11\n      }, this), _jsxDEV(View, {\n        style: styles.summaryContainer,\n        children: [_jsxDEV(Text, {\n          style: styles.summaryText,\n          children: [\"Total Price: \\u20B9\", totalPrice.toFixed(2)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 546,\n          columnNumber: 13\n        }, this), _jsxDEV(TouchableOpacity, {\n          onPress: handleCheckout,\n          style: styles.checkoutButton,\n          children: _jsxDEV(Text, {\n            style: styles.checkoutButtonText,\n            children: \"Proceed to Checkout\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 548,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 547,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 545,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 443,\n    columnNumber: 5\n  }, this);\n}\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    padding: 20,\n    backgroundColor: '#f7f7f7'\n  },\n  title: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    textAlign: 'center',\n    marginBottom: 20\n  },\n  cartItem: {\n    marginBottom: 15,\n    borderBottomWidth: 1,\n    borderBottomColor: '#ddd',\n    paddingBottom: 10\n  },\n  itemText: {\n    fontSize: 16,\n    marginBottom: 5\n  },\n  removeButton: {\n    marginTop: 10,\n    backgroundColor: '#FF6347',\n    padding: 10,\n    borderRadius: 5\n  },\n  removeButtonText: {\n    color: '#fff',\n    textAlign: 'center'\n  },\n  emptyCartText: {\n    fontSize: 18,\n    color: 'gray',\n    textAlign: 'center',\n    marginTop: 20\n  },\n  showItemsButton: {\n    marginTop: 10,\n    backgroundColor: '#4CAF50',\n    padding: 10,\n    borderRadius: 5\n  },\n  showItemsText: {\n    color: '#fff',\n    textAlign: 'center',\n    fontSize: 16\n  },\n  addressContainer: {\n    marginVertical: 20\n  },\n  inputLabel: {\n    fontSize: 16,\n    fontWeight: 'bold',\n    marginBottom: 5\n  },\n  input: {\n    borderWidth: 1,\n    borderColor: '#ccc',\n    borderRadius: 5,\n    padding: 10,\n    marginBottom: 10\n  },\n  paymentContainer: {\n    marginTop: 20,\n    padding: 10\n  },\n  paymentTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    marginBottom: 10\n  },\n  paymentOption: {\n    padding: 15,\n    marginVertical: 5,\n    borderRadius: 5,\n    borderWidth: 1,\n    borderColor: '#ddd'\n  },\n  selectedOption: {\n    borderColor: '#4CAF50',\n    backgroundColor: '#e8f5e9'\n  },\n  paymentText: {\n    fontSize: 16\n  },\n  summaryContainer: {\n    marginTop: 20,\n    padding: 15,\n    borderTopWidth: 1,\n    borderTopColor: '#ddd',\n    backgroundColor: '#fff',\n    borderRadius: 5\n  },\n  summaryText: {\n    fontSize: 18,\n    fontWeight: 'bold'\n  },\n  checkoutButton: {\n    marginTop: 10,\n    backgroundColor: '#FFA500',\n    padding: 15,\n    borderRadius: 5\n  },\n  checkoutButtonText: {\n    color: '#fff',\n    textAlign: 'center',\n    fontSize: 18\n  },\n  toggleButton: {\n    marginTop: 10,\n    backgroundColor: '#FFA500',\n    padding: 10,\n    borderRadius: 5\n  },\n  toggleButtonText: {\n    color: '#fff',\n    textAlign: 'center',\n    fontSize: 16\n  }\n});","map":{"version":3,"names":["React","useEffect","useState","View","Text","FlatList","TouchableOpacity","StyleSheet","Alert","TextInput","Animated","useCart","useNavigation","getFirestore","doc","getDoc","auth","onAuthStateChanged","Linking","Platform","Location","haversine","jsxDEV","_jsxDEV","Fragment","_Fragment","SHOP_LOCATION","latitude","longitude","CartScreen","cart","removeFromCart","totalPrice","currentUser","setCurrentUser","selectedPayment","setSelectedPayment","name","setName","contactNumber","setContactNumber","address","setAddress","isExpanded","setIsExpanded","animatedHeight","Value","navigation","userDetails","setUserDetails","location","setLocation","distance","setDistance","fetchUserDetails","user","db","userDoc","uid","exists","data","error","console","getCurrentLocation","status","requestForegroundPermissionsAsync","alert","getCurrentPositionAsync","coords","calculateDistance","userCoords","distanceInMeters","distanceInKm","toFixed","handleManualAddress","showAlert","title","message","onRemove","OS","confirmation","window","confirm","text","style","onPress","unsubscribe","handleRemove","id","sendOrderMessage","paymentType","orderDetails","map","item","cartQuantity","join","openURL","encodeURIComponent","ownerNumber","handleCheckout","navigate","timing","toValue","duration","useNativeDriver","start","toggleExpand","prev","renderCartItem","styles","cartItem","children","itemText","fileName","_jsxFileName","lineNumber","columnNumber","price","removeButton","removeButtonText","container","length","emptyCartText","renderItem","keyExtractor","toString","height","overflow","toggleButton","toggleButtonText","addressContainer","inputLabel","input","value","onChangeText","placeholder","keyboardType","paymentContainer","paymentTitle","paymentOption","selectedOption","paymentText","summaryContainer","summaryText","checkoutButton","checkoutButtonText","create","flex","padding","backgroundColor","fontSize","fontWeight","textAlign","marginBottom","borderBottomWidth","borderBottomColor","paddingBottom","marginTop","borderRadius","color","showItemsButton","showItemsText","marginVertical","borderWidth","borderColor","borderTopWidth","borderTopColor"],"sources":["/Users/payalsah/Documents/FruitShopApp/screens/CartScreen.tsx"],"sourcesContent":["// import React, { useEffect, useState } from 'react';\n// import {\n//   View,\n//   Text,\n//   FlatList,\n//   TouchableOpacity,\n//   StyleSheet,\n//   Alert,\n// } from 'react-native';\n// import { useCart } from '../contexts/CartContext'; // Cart context\n// import { useNavigation } from '@react-navigation/native';\n// import { auth } from '../firebaseConfig';\n// import { onAuthStateChanged } from 'firebase/auth';\n// import { User } from 'firebase/auth';\n// import { RootStackParamList } from '../navigation/types';\n// import { NativeStackNavigationProp } from '@react-navigation/native-stack';\n\n\n// interface CartItem {\n//   id: number;\n//   name: string;\n//   price: number;\n//   cartQuantity: number;\n// }\n\n// type CartScreenNavigationProp = NativeStackNavigationProp<RootStackParamList, 'Cart'>;\n\n\n// export default function CartScreen() {\n//   const { cart, removeFromCart, totalPrice } = useCart(); // Cart context\n//   const [user, setUser] = useState(null); // Firebase auth state\n//   const [selectedPayment, setSelectedPayment] = useState<string | null>(null);\n//   const [currentUser, setCurrentUser] = useState<User | null>(null); // Allow User | null\n//   const navigation = useNavigation();\n\n//   useEffect(() => {\n//     const unsubscribe = onAuthStateChanged(auth, (user) => {\n//       setCurrentUser(user); // Sets the user if logged in\n//     });\n//     return () => unsubscribe(); // Cleanup subscription\n//   }, []);\n\n//   const handleRemove = (id: number) => {\n//     Alert.alert('Remove Item', 'Are you sure you want to remove this item from your cart?', [\n//       { text: 'Cancel', style: 'cancel' },\n//       { text: 'Remove', onPress: () => removeFromCart(id) },\n//     ]);\n//   };\n\n//   const handleCheckout = () => {\n//     if (!currentUser) {\n//       // If user not logged in, navigate to login\n//       Alert.alert(\n//         'Authentication Required',\n//         'You need to log in to proceed to checkout.',\n//         [\n//           { text: 'Cancel', style: 'cancel' },\n//           { text: 'Login', onPress: () => navigation.navigate('Login') },\n//         ]\n//       );\n//     } else if (selectedPayment === 'Online Payment') {\n//       // Navigate to online payment\n//       navigation.navigate('OnlinePayment'); // Replace with your Online Payment screen\n//     } else if (selectedPayment === 'Cash on Delivery') {\n//       // Confirm cash on delivery order\n//       Alert.alert('Order Confirmed', 'Your order will be paid on delivery.');\n//     } else {\n//       // No payment method selected\n//       Alert.alert('Select Payment Method', 'Please choose a payment method to proceed.');\n//     }\n//   };\n\n//   const renderCartItem = ({ item }: { item: CartItem }) => (\n//     <View style={styles.cartItem}>\n//       <Text style={styles.itemText}>{item.name}</Text>\n//       <Text style={styles.itemText}>Quantity: {item.cartQuantity}</Text>\n//       <Text style={styles.itemText}>Price: â‚¹{item.price.toFixed(2)}</Text>\n//       <TouchableOpacity onPress={() => handleRemove(item.id)} style={styles.removeButton}>\n//         <Text style={styles.removeButtonText}>Remove</Text>\n//       </TouchableOpacity>\n//     </View>\n//   );\n\n//   return (\n//     <View style={styles.container}>\n//       <Text style={styles.title}>Your Cart</Text>\n//       {cart.length === 0 ? (\n//         <Text style={styles.emptyCartText}>Your cart is empty.</Text>\n//       ) : (\n//         <>\n//           <FlatList\n//             data={cart}\n//             renderItem={renderCartItem}\n//             keyExtractor={(item) => item.id.toString()}\n//           />\n//           <View style={styles.paymentContainer}>\n//             <Text style={styles.paymentTitle}>Select Payment Method:</Text>\n//             <TouchableOpacity\n//               style={[\n//                 styles.paymentOption,\n//                 selectedPayment === 'Cash on Delivery' && styles.selectedOption,\n//               ]}\n//               onPress={() => setSelectedPayment('Cash on Delivery')}\n//             >\n//               <Text style={styles.paymentText}>Cash on Delivery</Text>\n//             </TouchableOpacity>\n//             <TouchableOpacity\n//               style={[\n//                 styles.paymentOption,\n//                 selectedPayment === 'Online Payment' && styles.selectedOption,\n//               ]}\n//               onPress={() => setSelectedPayment('Online Payment')}\n//             >\n//               <Text style={styles.paymentText}>Online Payment</Text>\n//             </TouchableOpacity>\n//           </View>\n//           <View style={styles.summaryContainer}>\n//             <Text style={styles.summaryText}>Total Price: â‚¹{totalPrice.toFixed(2)}</Text>\n//             <TouchableOpacity onPress={handleCheckout} style={styles.checkoutButton}>\n//               <Text style={styles.checkoutButtonText}>Proceed to Checkout</Text>\n//             </TouchableOpacity>\n//           </View>\n//         </>\n//       )}\n//     </View>\n//   );\n// }\n\n// const styles = StyleSheet.create({\n//   container: {\n//     flex: 1,\n//     padding: 20,\n//     backgroundColor: '#f7f7f7',\n//   },\n//   title: {\n//     fontSize: 24,\n//     fontWeight: 'bold',\n//     textAlign: 'center',\n//     marginBottom: 20,\n//   },\n//   cartItem: {\n//     marginBottom: 15,\n//     borderBottomWidth: 1,\n//     borderBottomColor: '#ddd',\n//     paddingBottom: 10,\n//   },\n//   itemText: {\n//     fontSize: 16,\n//     marginBottom: 5,\n//   },\n//   removeButton: {\n//     marginTop: 10,\n//     backgroundColor: '#FF6347',\n//     padding: 10,\n//     borderRadius: 5,\n//   },\n//   removeButtonText: {\n//     color: '#fff',\n//     textAlign: 'center',\n//   },\n//   emptyCartText: {\n//     fontSize: 18,\n//     color: 'gray',\n//     textAlign: 'center',\n//     marginTop: 20,\n//   },\n//   paymentContainer: {\n//     marginTop: 20,\n//     padding: 10,\n//   },\n//   paymentTitle: {\n//     fontSize: 18,\n//     fontWeight: 'bold',\n//     marginBottom: 10,\n//   },\n//   paymentOption: {\n//     padding: 15,\n//     marginVertical: 5,\n//     borderRadius: 5,\n//     borderWidth: 1,\n//     borderColor: '#ddd',\n//   },\n//   selectedOption: {\n//     borderColor: '#4CAF50',\n//     backgroundColor: '#e8f5e9',\n//   },\n//   paymentText: {\n//     fontSize: 16,\n//   },\n//   summaryContainer: {\n//     marginTop: 20,\n//     padding: 15,\n//     borderTopWidth: 1,\n//     borderTopColor: '#ddd',\n//     backgroundColor: '#fff',\n//     borderRadius: 5,\n//   },\n//   summaryText: {\n//     fontSize: 18,\n//     fontWeight: 'bold',\n//   },\n//   checkoutButton: {\n//     marginTop: 10,\n//     backgroundColor: '#4CAF50',\n//     padding: 15,\n//     borderRadius: 5,\n//   },\n//   checkoutButtonText: {\n//     color: '#fff',\n//     textAlign: 'center',\n//     fontSize: 18,\n//   },\n// });\n\n\n\nimport React, { useContext ,useEffect, useState  } from 'react';\nimport {\n  View,\n  Text,\n  FlatList,\n  TouchableOpacity,\n  StyleSheet,\n  Alert,\n  TextInput,\n  // Modal,\n  ScrollView,\n  Animated,\n  ActivityIndicator\n} from 'react-native';\nimport { useCart } from '../contexts/CartContext'; // Cart context\nimport { useNavigation } from '@react-navigation/native';\nimport { getFirestore, doc, getDoc } from 'firebase/firestore';\nimport { auth } from '../firebaseConfig';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport { User } from 'firebase/auth';\nimport { RootStackParamList } from '../navigation/types';\nimport { NativeStackNavigationProp } from '@react-navigation/native-stack';\nimport * as Linking from 'expo-linking';\nimport { Platform } from 'react-native';\nimport * as Location from 'expo-location';\nimport haversine from 'haversine-distance';\n\n\n// Owner's Fixed Address (Fruit Shop Location)\nconst SHOP_LOCATION = {\n  latitude: 28.7041, // Example: Delhi, India\n  longitude: 77.1025,\n};\n\nexport interface CartItem {\n  id: number;\n  name: string;\n  price: number;\n  cartQuantity: number;\n}\n\ntype CartScreenNavigationProp = NativeStackNavigationProp<RootStackParamList, 'Cart'>;\n\nexport default function CartScreen() {\n  const { cart, removeFromCart, totalPrice } = useCart(); // Cart context\n  const [currentUser, setCurrentUser] = useState<User | null>(null); // Firebase auth state\n  const [selectedPayment, setSelectedPayment] = useState<string | null>(null);\n  const [name, setName] = useState('');\n  const [contactNumber, setContactNumber] = useState('');\n  const [address, setAddress] = useState('');\n  // const [isModalVisible, setModalVisible] = useState(false); // Modal visibility state\n  const [isExpanded, setIsExpanded] = useState(true); // State to track if the list is expanded\n  const [animatedHeight] = useState(new Animated.Value(0)); // Animated value for height transition\n  const navigation = useNavigation<CartScreenNavigationProp>();\n\n  const [userDetails, setUserDetails] = useState<any>(null); \n  const [location, setLocation] = useState<any>(null);\n  const [distance, setDistance] = useState<any>(null);\n\n  // Fetch user details (including address if available)\n  useEffect(() => {\n    const fetchUserDetails = async () => {\n      const user = auth.currentUser;\n      if (user) {\n        try {\n          const db = getFirestore();\n          const userDoc = await getDoc(doc(db, 'users', user.uid));\n          if (userDoc.exists()) {\n            setUserDetails(userDoc.data());\n            setAddress(userDoc.data().address || ''); // Set saved address\n            setName(userDoc.data())\n          }\n        } catch (error) {\n          console.error('Error fetching user details: ', error);\n        }\n      }\n    };\n    fetchUserDetails();\n  }, []);\n\n  // Get User's Current Location\n  const getCurrentLocation = async () => {\n    const { status } = await Location.requestForegroundPermissionsAsync();\n    if (status !== 'granted') {\n      Alert.alert('Permission Denied', 'Location access is required to detect your address.');\n      return;\n    }\n    \n    const location = await Location.getCurrentPositionAsync({});\n    setLocation(location.coords);\n    setAddress(`Lat: ${location.coords.latitude}, Lng: ${location.coords.longitude}`);\n\n    // Calculate distance from shop\n    calculateDistance(location.coords);\n  };\n\n  // Calculate Distance from Shop\n  const calculateDistance = (userCoords) => {\n    if (!userCoords) return;\n    const distanceInMeters = haversine(SHOP_LOCATION, userCoords);\n    const distanceInKm = distanceInMeters / 1000;\n    setDistance(distanceInKm.toFixed(2));\n\n    if (distanceInKm > 5) {\n      Alert.alert('Out of Delivery Range', 'Sorry, delivery is only available within 5km.');\n    }\n  };\n\n  // Handle Manual Address Input\n  const handleManualAddress = () => {\n    Alert.alert('Manual Address', 'Your address has been updated.');\n    // Here, you can use Google Maps API to convert address to coordinates if needed\n  };\n\n\n  const showAlert = (title: string, message: string, onRemove: () => void) => {\n  if (Platform.OS === 'web') {\n    const confirmation = window.confirm(`${title}: ${message}`);\n    if (confirmation) {\n      onRemove();\n    }\n  } else {\n    Alert.alert(\n      title,\n      message,\n      [\n        { text: 'Cancel', style: 'cancel' },\n        { text: 'Ok', onPress: onRemove },\n      ]\n    );\n  }\n};\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      setCurrentUser(user); // Sets the user if logged in\n    });\n    return () => unsubscribe(); // Cleanup subscription\n  }, []);\n\n  const handleRemove = (id: number) => {\n    showAlert('Remove Item', 'Are you sure you want to remove this item from your cart?', () => removeFromCart(id));\n  };\n\n  const sendOrderMessage = (paymentType: string) => {\n    const orderDetails = cart\n      .map((item) => `${item.name} x${item.cartQuantity}`)\n      .join(', ');\n    const message = `Order Details:\\nName: ${name}\\nContact: ${contactNumber}\\nProducts: ${orderDetails}\\nTotal Price: â‚¹${totalPrice.toFixed(\n      2\n    )}\\nPayment Method: ${paymentType}`;\n\n\n    // Send message to the customer\n    Linking.openURL(`sms:${contactNumber}?body=${encodeURIComponent(message)}`);\n    Linking.openURL(`whatsapp://send?phone=${contactNumber}&text=${encodeURIComponent(message)}`);\n\n    // Send message to the owner\n    const ownerNumber = '+916205720019';\n    Linking.openURL(`sms:${ownerNumber}?body=${encodeURIComponent(message)}`);\n    Linking.openURL(`whatsapp://send?phone=${ownerNumber}&text=${encodeURIComponent(message)}`);\n  \n\n  };\n\n  const handleCheckout = () => {\n    if (!currentUser) {\n      // If user not logged in, navigate to login\n      showAlert(\n        'Authentication Required',\n        'You need to log in to proceed to checkout.',\n        () => navigation.navigate('Login')\n      );\n    } else if (!name || !contactNumber || !address) {\n      showAlert('Missing Information', 'Please provide your name , contact number and address.' , () => {});\n    } else if (selectedPayment === 'Cash on Delivery') {\n      // Confirm Cash on Delivery order\n      showAlert('Order Confirmed', 'Your order has been placed and will be paid on delivery.', () => {\n        sendOrderMessage('Cash on Delivery'); // âœ… Automatically send message after confirming order\n      });      \n    } else if (selectedPayment === 'Online Payment') {\n      // Navigate to Online Payment\n      navigation.navigate('OnlinePayment', {\n        name,\n        contactNumber,\n        totalPrice,\n        cart,\n        address,\n      });\n      sendOrderMessage('Online Payment'); // âœ… Automatically send message for online payment\n    } else {\n      showAlert('Select Payment Method', 'Please choose a payment method to proceed.' , () => {});\n    }\n  };\n\n  // const toggleModal = () => {\n  //   setModalVisible(!isModalVisible);\n  // };\n\n  useEffect(() => {\n    // Animate the height change\n    Animated.timing(animatedHeight, {\n      toValue: isExpanded ? 300 : 0, // Adjust the height value as needed\n      duration: 300,\n      useNativeDriver: false,\n    }).start();\n  }, [isExpanded]);\n\n  const toggleExpand = () => {\n    setIsExpanded((prev) => !prev);\n  };\n\n\n\n  const renderCartItem = ({ item }: { item: CartItem }) => (\n    <View style={styles.cartItem}>\n      <Text style={styles.itemText}>{item.name}</Text>\n      <Text style={styles.itemText}>Quantity: {item.cartQuantity}</Text>\n      <Text style={styles.itemText}>Price: â‚¹{item.price.toFixed(2)}</Text>\n      <TouchableOpacity onPress={() => handleRemove(item.id)} style={styles.removeButton}>\n        <Text style={styles.removeButtonText}>Remove</Text>\n      </TouchableOpacity>\n    </View>\n  );\n\n  return (\n    <View style={styles.container}>\n      <Text style={styles.title}>Your Cart</Text>\n      \n      {cart.length === 0 ? (\n        <Text style={styles.emptyCartText}>Your cart is empty.</Text>\n      ) : (\n        <>\n          <FlatList\n            data={cart}\n            renderItem={renderCartItem}\n            keyExtractor={(item) => item.id.toString()}\n          />\n\n            <Animated.View style={{ height: animatedHeight, overflow: 'hidden' }}>\n              <FlatList\n                data={cart} // Show the remaining items in the expanded section\n                renderItem={renderCartItem}\n                keyExtractor={(item) => item.id.toString()}\n              />\n            </Animated.View>\n            <TouchableOpacity onPress={toggleExpand} style={styles.toggleButton}>\n              <Text style={styles.toggleButtonText}>{isExpanded ? 'View Less' : 'View All Items'}</Text>\n            </TouchableOpacity>\n\n          {/* <TouchableOpacity onPress={toggleModal} style={styles.showItemsButton}>\n            <Text style={styles.showItemsText}>View All Items</Text>\n          </TouchableOpacity> */}\n\n          {/* Modal for displaying all cart items */}\n          {/* <Modal\n            visible={isModalVisible}\n            transparent={true}\n            animationType=\"slide\"\n            onRequestClose={toggleModal}\n          >\n            <View style={styles.modalContainer}>\n              <View style={styles.modalContent}>\n                <Text style={styles.modalTitle}>Cart Items</Text>\n                <ScrollView>\n                  {cart.map((item) => (\n                    <View key={item.id} style={styles.modalItem}>\n                      <Text style={styles.itemText}>{item.name}</Text>\n                      <Text style={styles.itemText}>Quantity: {item.cartQuantity}</Text>\n                      <Text style={styles.itemText}>Price: â‚¹{item.price.toFixed(2)}</Text>\n                    </View>\n                  ))}\n                </ScrollView>\n                <TouchableOpacity onPress={toggleModal} style={styles.closeModalButton}>\n                  <Text style={styles.closeModalText}>Close</Text>\n                </TouchableOpacity>\n              </View>\n            </View>\n          </Modal> */}\n          \n          <View style={styles.addressContainer}>\n            <Text style={styles.inputLabel}>Name:</Text>\n            <TextInput\n              style={styles.input}\n              value={name}\n              onChangeText={setName}\n              placeholder=\"Enter your name\"\n            />\n            <Text style={styles.inputLabel}>Contact Number:</Text>\n            <TextInput\n              style={styles.input}\n              value={contactNumber}\n              onChangeText={setContactNumber}\n              placeholder=\"Enter your contact number\"\n              keyboardType=\"phone-pad\"\n            />\n            <Text style={styles.inputLabel}>Address:</Text>\n            <TextInput\n              style={styles.input}\n              value={address}\n              onChangeText={setAddress}\n              placeholder=\"Enter your address\"\n              // returnKeyType=\"done\"\n              // onSubmitEditing={() => Keyboard.dismiss()}\n            />\n            \n          </View>\n          <View style={styles.paymentContainer}>\n            <Text style={styles.paymentTitle}>Select Payment Method:</Text>\n            <TouchableOpacity\n              style={[\n                styles.paymentOption,\n                selectedPayment === 'Cash on Delivery' && styles.selectedOption,\n              ]}\n              onPress={() => setSelectedPayment('Cash on Delivery')}\n            >\n              <Text style={styles.paymentText}>Cash on Delivery</Text>\n            </TouchableOpacity>\n            <TouchableOpacity\n              style={[\n                styles.paymentOption,\n                selectedPayment === 'Online Payment' && styles.selectedOption,\n              ]}\n              onPress={() => setSelectedPayment('Online Payment')}\n            >\n              <Text style={styles.paymentText}>Online Payment</Text>\n            </TouchableOpacity>\n          </View>\n          <View style={styles.summaryContainer}>\n            <Text style={styles.summaryText}>Total Price: â‚¹{totalPrice.toFixed(2)}</Text>\n            <TouchableOpacity onPress={handleCheckout} style={styles.checkoutButton}>\n              <Text style={styles.checkoutButtonText}>Proceed to Checkout</Text>\n            </TouchableOpacity>\n          </View>\n        </>\n      )}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: { flex: 1, padding: 20, backgroundColor: '#f7f7f7' },\n  title: { fontSize: 24, fontWeight: 'bold', textAlign: 'center', marginBottom: 20 },\n  cartItem: { marginBottom: 15, borderBottomWidth: 1, borderBottomColor: '#ddd', paddingBottom: 10 },\n  itemText: { fontSize: 16, marginBottom: 5 },\n  removeButton: { marginTop: 10, backgroundColor: '#FF6347', padding: 10, borderRadius: 5 },\n  removeButtonText: { color: '#fff', textAlign: 'center' },\n  emptyCartText: { fontSize: 18, color: 'gray', textAlign: 'center', marginTop: 20 },\n  showItemsButton: { marginTop: 10, backgroundColor: '#4CAF50', padding: 10, borderRadius: 5 },\n  showItemsText: { color: '#fff', textAlign: 'center', fontSize: 16 },\n  // modalContainer: { flex: 1, justifyContent: 'center', backgroundColor: 'rgba(0,0,0,0.5)' },\n  // modalContent: { backgroundColor: '#fff', padding: 20, marginHorizontal: 20, borderRadius: 10 },\n  // modalTitle: { fontSize: 20, fontWeight: 'bold', marginBottom: 10, textAlign: 'center' },\n  // modalItem: { marginBottom: 15, borderBottomWidth: 1, borderBottomColor: '#ddd', paddingBottom: 10 },\n  // closeModalButton: { marginTop: 10, backgroundColor: '#FF6347', padding: 10, borderRadius: 5 },\n  // closeModalText: { color: '#fff', textAlign: 'center', fontSize: 16 },\n  addressContainer: { marginVertical: 20 },\n  inputLabel: { fontSize: 16, fontWeight: 'bold', marginBottom: 5 },\n  input: { borderWidth: 1, borderColor: '#ccc', borderRadius: 5, padding: 10, marginBottom: 10 },\n  paymentContainer: { marginTop: 20, padding: 10 },\n  paymentTitle: { fontSize: 18, fontWeight: 'bold', marginBottom: 10 },\n  paymentOption: { padding: 15, marginVertical: 5, borderRadius: 5, borderWidth: 1, borderColor: '#ddd' },\n  selectedOption: { borderColor: '#4CAF50', backgroundColor: '#e8f5e9' },\n  paymentText: { fontSize: 16 },\n  summaryContainer: { marginTop: 20, padding: 15, borderTopWidth: 1, borderTopColor: '#ddd', backgroundColor: '#fff', borderRadius: 5 },\n  summaryText: { fontSize: 18, fontWeight: 'bold' },\n  checkoutButton: { marginTop: 10, backgroundColor: '#FFA500', padding: 15, borderRadius: 5 },\n  checkoutButtonText: { color: '#fff', textAlign: 'center', fontSize: 18 },\n  toggleButton: { marginTop: 10, backgroundColor: '#FFA500', padding: 10, borderRadius: 5 },\n  toggleButtonText: { color: '#fff', textAlign: 'center', fontSize: 16 },\n});\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}